{% extends 'base.html' %}

{% block content %}
  
  <h1>My Google Map</h1>
  <div id="map"></div>


  <script>
    var arrOfMarkers = [] 

    function initMap(){

      // map options
      // zoom level and center location
      var options = {
        zoom: 12,
        center: arrOfMarkers[0]
      }

      // new map
      var map = new google.maps.Map(document.getElementById('map'), options);

      for(var i = 0; i < arrOfMarkers.length; i++) {
        addMarker(arrOfMarkers[i])
      }

      function addMarker(coords) {
        var marker = new google.maps.Marker({
          position: coords,
          map: map,
          icon: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'
        });
      }

    }
  </script>

{% for location in marked_locations %}
  <!-- crete a js array of marked locations from python list -->
  <script>
    var latitude = {{ location.lat }};
    var longitude = {{ location.lng }}
    var coords = {lat: latitude, lng: longitude}
    arrOfMarkers.push(coords);
    // console.log(arrOfMarkers)
  </script>
{% endfor %}

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAupcjCtFw-x5bW2TuKSC6rsBFbmhcGCaA&libraries=places&callback=initMap"
         async defer></script>
  </body>

{% endblock %}